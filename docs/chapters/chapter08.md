---
layout: book
order: 10
title: "第8章：暗号の扉を開いた数学的革命"
---

# 第8章：暗号の扉を開いた数学的革命

## 〜ホイットフィールド・ディフィー（1944-）&マーティン・ヘルマン（1945-）〜

### ドラマチックな導入

1975年11月、カリフォルニア州スタンフォード大学。午後の陽射しが差し込む研究室で、二人の数学者が激しい議論を交わしていた。一人は長い髪とヒゲが印象的なホイットフィールド・ディフィー、31歳。もう一人は真面目な表情のマーティン・ヘルマン、30歳。

机の上には、何枚ものメモ用紙に書かれた数式と図表が散乱していた。二人が取り組んでいたのは、2000年以上にわたって暗号学者を悩ませてきた根本的な問題だった。

「どうすれば、事前に秘密鍵を交換することなく、安全な通信ができるのか？」

この問題は「鍵配布問題」と呼ばれ、暗号の最大の弱点とされていた。アリスとボブが安全に通信するには、事前に秘密の鍵を共有する必要がある。しかし、その鍵自体をどうやって安全に送るのか？これは卵と鶏の問題のようなパラドックスだった。

「不可能だ」—多くの専門家がそう断言していた。数学的に証明不可能な問題だと。

しかし、ディフィーとヘルマンは信じていた。「数学には必ず解がある」と。そして1976年、彼らは数学史上最も革命的な発見の一つを成し遂げる。「公開鍵暗号」の発明である。

あなたがクレジットカードでオンラインショッピングをするとき、銀行のWebサイトにログインするとき、メッセージアプリで友人とやり取りするとき—その安全性は、50年前にこの二人が解いた数学的難問によって守られている。インターネット時代の安全性の基盤は、二人の数学者の「不可能への挑戦」から生まれたのである。

---

## 8.1 冷戦時代の暗号学

### 政府独占の暗号技術

1970年代初頭、暗号学は政府と軍事機関の専有物だった。アメリカでは国家安全保障局（NSA）が、ソ連ではKGBが、それぞれ最先端の暗号技術を開発し、厳重に秘匿していた。

民間企業や一般研究者が暗号について研究することは、実質的に不可能だった。技術情報は機密扱いされ、関連する論文の発表さえ制限されていた。

**冷戦時代の暗号環境**：
- **政府独占**：NSA、軍事機関のみが高度な暗号技術を保有
- **機密性**：暗号アルゴリズムは国家機密として厳重管理
- **限定的利用**：軍事・外交通信のみで使用
- **学術研究の制限**：大学での暗号学研究は事実上禁止

### 民間でのデータ保護需要の高まり

しかし、1970年代に入ると状況が変化し始めた。コンピュータの普及により、民間企業でも機密情報をデジタル化して保存・送信する必要性が生まれてきた。

**民間でのデータ保護需要**：
- **銀行システム**：電子資金移動、ATMネットワーク
- **企業通信**：機密文書の電子送信
- **個人プライバシー**：電話盗聴への懸念
- **コンピュータセキュリティ**：データベースへの不正アクセス防止

1973年、アメリカ商務省標準局（現NIST）は、民間向け暗号標準の公募を開始した。これが後に「DES（Data Encryption Standard）」として採用されることになる。

### DESと「鍵配布問題」

1975年、DESが正式に採用された。これは、民間で初めて使える標準暗号だったが、根本的な問題を抱えていた。

**DES（Data Encryption Standard）の特徴**：
- **共通鍵暗号**：暗号化と復号で同じ鍵を使用
- **56ビット鍵**：約7京通りの組み合わせ
- **高速処理**：コンピュータでの実装に適している
- **標準化**：世界中で統一的に使用可能

しかし、DESには致命的な弱点があった：「鍵配布問題」である。

**鍵配布問題の本質**：
```
アリス ←──── 暗号化メッセージ ────→ ボブ
   ↑                                ↑
   │        どうやって安全に        │
   └──────── 秘密鍵 ────────────┘
           送信するのか？
```

- アリスとボブが安全に通信するには、事前に秘密鍵を共有する必要
- しかし、その秘密鍵自体をどうやって安全に送るのか？
- 第三者（イブ）が鍵を盗聴する可能性
- 鍵管理のコストと複雑さ

### ホイットフィールド・ディフィーの問題意識

ホイットフィールド・ディフィー（1944年生まれ）は、この問題に深い関心を持っていた。MIT で数学を学んだ後、IBMでセキュリティ研究に従事していた彼は、暗号学の根本的な限界に疑問を抱いていた。

**ディフィーの背景**：
- **学歴**：MIT数学科卒業（1965年）
- **職歴**：IBM、MITRE Corporation での研究
- **専門**：数学、計算理論、情報セキュリティ
- **性格**：独立心旺盛、権威への懐疑、学際的思考

ディフィーは、暗号学を政府の独占から解放し、民間でも使える実用的な技術にしたいと考えていた。特に、個人のプライバシー保護のために、誰でも使える強力な暗号技術が必要だと信じていた。

**ディフィーの理念**：
「暗号技術は政府の独占物ではない。個人のプライバシーを守るために、誰でもアクセスできる暗号技術が必要だ」

1974年、ディフィーはスタンフォード大学でマーティン・ヘルマンと出会った。この出会いが、暗号学史上最大の革命の始まりとなる。

---

## 8.2 スタンフォード大学での運命的な出会い

### マーティン・ヘルマンの暗号への関心

マーティン・エドワード・ヘルマン（1945年生まれ）は、スタンフォード大学の電気工学科の助教授だった。ニューヨーク市生まれの彼は、ニューヨーク大学で学士号、スタンフォード大学で博士号を取得し、IBMで研究経験を積んだ後、母校に戻って教員となっていた。

**ヘルマンの背景**：
- **学歴**：NYU学士（1966年）、スタンフォード大学博士（1969年）
- **専門**：情報理論、信号処理、通信工学
- **研究関心**：数学的厳密性、実用的応用
- **性格**：慎重、論理的、協調的

ヘルマンは当初、暗号学の専門家ではなかった。しかし、1970年代初頭に暗号学に興味を持ち始め、この分野の数学的可能性に魅力を感じていた。

### 1974年の出会いと共同研究開始

1974年、ディフィーがスタンフォード大学を訪問した際、二人は運命的な出会いを果たした。最初は短い会話だったが、すぐに二人は共通の問題意識を持っていることを発見した。

**共通の関心事**：
- **鍵配布問題の解決**：事前鍵交換なしの安全通信
- **暗号学の民主化**：政府独占からの解放
- **数学的厳密性**：理論的に証明可能な安全性
- **実用的応用**：コンピュータ時代の暗号技術

ディフィーは、スタンフォード大学の客員研究員として参加し、ヘルマンとの本格的な共同研究を開始した。

### 数学的アプローチへの転換

従来の暗号学は、主に「パズル的」なアプローチだった。複雑な手順で文字を置き換えたり、移動させたりすることで暗号を作る。しかし、ディフィーとヘルマンは、より数学的なアプローチを採用した。

**新しいアプローチの特徴**：
- **数論の活用**：素数、離散対数などの数学的困難性
- **計算量理論**：計算時間の解析と評価
- **確率論的安全性**：統計的な安全性の保証
- **アルゴリズム設計**：コンピュータでの効率的実装

特に重要だったのは、「一方向関数」という概念だった。

**一方向関数の概念**：
```
f(x) は計算しやすいが、
y = f(x) から x を求めることは困難

例：
x * y = n  （計算しやすい）
n から x, y を求める（素因数分解）は困難
```

この概念を暗号に応用できれば、従来不可能とされていた問題を解決できる可能性があった。

### 「公開鍵」という革命的発想

1975年秋、ディフィーとヘルマンは画期的なアイデアにたどり着いた。「公開鍵暗号」という概念である。

**公開鍵暗号の基本アイデア**：
```
従来の共通鍵暗号：
暗号化鍵 = 復号化鍵 = 秘密鍵

新しい公開鍵暗号：
暗号化鍵 ≠ 復号化鍵
暗号化鍵（公開鍵）→ 公開してもよい
復号化鍵（秘密鍵）→ 秘密にする
```

この発想は、常識を覆すものだった。「暗号化に使う鍵を公開する」など、誰も考えたことがなかった。

**革命性の理由**：
1. **鍵配布問題の解決**：事前に秘密を共有する必要がない
2. **スケーラビリティ**：n人の通信に必要な鍵数が n個（従来は n(n-1)/2個）
3. **デジタル署名**：偽造不可能な電子署名が可能
4. **暗号学の民主化**：誰でも安全な暗号を使用可能

### 1976年の歴史的論文

1976年11月、ディフィーとヘルマンは「New Directions in Cryptography（暗号学の新しい方向性）」という論文を発表した。この論文は、暗号学史上最も重要な文書の一つとなった。

**論文の主要内容**：
1. **公開鍵暗号の概念提示**：理論的枠組みの確立
2. **デジタル署名**：偽造不可能な電子署名の可能性
3. **鍵交換プロトコル**：Diffie-Hellman鍵交換の提案
4. **一方向関数の重要性**：数学的困難性に基づく安全性

特に、「Diffie-Hellman鍵交換」は、公開鍵暗号の最初の実用的な実装だった。

**Diffie-Hellman鍵交換の仕組み**：
```
1. アリスとボブが公開パラメータ p, g を共有
2. アリスは秘密数 a を選び、A = g^a mod p を計算して公開
3. ボブは秘密数 b を選び、B = g^b mod p を計算して公開
4. アリスは k = B^a mod p を計算
5. ボブは k = A^b mod p を計算
6. 両者とも同じ値 k = g^(ab) mod p を得る

盗聴者は A, B を知っているが、a, b は分からない
（離散対数問題の困難性による）
```

この方法により、公開チャネルで安全に共通鍵を確立できるようになった。

---

## 8.3 公開鍵暗号の実現

### RSA暗号の発明

ディフィー・ヘルマンの論文は大きな反響を呼んだが、一つの問題が残されていた。彼らは公開鍵暗号の「概念」を示したが、実用的な「実装」は提示していなかった。

この問題を解決したのが、MIT の3人の研究者だった：ロン・リベスト（Ron Rivest）、アディ・シャミア（Adi Shamir）、レナード・エーデルマン（Leonard Adleman）。

**RSA開発の経緯**：
- **1977年**：3人がディフィー・ヘルマンの論文に触発される
- **研究期間**：約1年間の試行錯誤
- **困難**：適切な一方向関数の発見
- **成功**：素因数分解の困難性を利用

**RSA暗号の仕組み**：
```
鍵生成：
1. 大きな素数 p, q を選ぶ
2. n = p × q を計算
3. φ(n) = (p-1)(q-1) を計算
4. gcd(e, φ(n)) = 1 となる e を選ぶ
5. ed ≡ 1 (mod φ(n)) となる d を計算
6. 公開鍵：(n, e)、秘密鍵：(n, d)

暗号化：C = M^e mod n
復号化：M = C^d mod n
```

RSAの安全性は、大きな合成数の素因数分解が困難であることに基づいている。現在の技術では、数百桁の合成数を素因数分解することは実質的に不可能とされている。

### 楕円曲線暗号の発展

1980年代中頃、ニール・コブリッツ（Neal Koblitz）とビクター・ミラー（Victor Miller）が独立に「楕円曲線暗号」を提案した。これは、RSAとは異なる数学的基盤を持つ公開鍵暗号だった。

**楕円曲線暗号の特徴**：
- **数学的基盤**：楕円曲線上の離散対数問題
- **鍵サイズ**：RSAより短い鍵で同等の安全性
- **効率性**：計算量とメモリ使用量の削減
- **携帯機器適用**：スマートカード、IoTデバイスに適している

**楕円曲線の数学**：
```
楕円曲線：y² = x³ + ax + b
点の加法演算が定義される
楕円曲線上の点 P に対して、nP を計算するのは容易
しかし、Q = nP から n を求めるのは困難
```

楕円曲線暗号は、特にモバイル機器やIoTデバイスで広く使用されている。

### デジタル署名の実現

公開鍵暗号のもう一つの重要な応用が「デジタル署名」である。これにより、電子文書の真正性と完全性を保証できるようになった。

**デジタル署名の原理**：
```
署名生成：
1. 文書のハッシュ値を計算
2. 秘密鍵でハッシュ値を「暗号化」（署名生成）

署名検証：
1. 文書のハッシュ値を計算
2. 公開鍵で署名を「復号化」
3. 両者が一致すれば署名は有効
```

**デジタル署名の特徴**：
- **認証**：署名者の身元確認
- **完全性**：文書の改ざん検出
- **否認防止**：署名者は後から否認できない
- **効率性**：物理的な署名より迅速・確実

### 暗号学的ハッシュ関数

デジタル署名の実装には、「暗号学的ハッシュ関数」が不可欠だった。これは、任意長の入力を固定長の出力に変換する一方向関数である。

**暗号学的ハッシュ関数の要件**：
1. **一方向性**：ハッシュ値から元の入力を求めることが困難
2. **耐衝突性**：異なる入力から同じハッシュ値が出ることが困難
3. **決定性**：同じ入力からは常に同じハッシュ値
4. **雪崩効果**：入力の僅かな変化で出力が大きく変化

**主要なハッシュ関数**：
- **MD5**（1991年）：128ビット出力、現在は非推奨
- **SHA-1**（1995年）：160ビット出力、段階的に非推奨
- **SHA-256**（2001年）：256ビット出力、現在の標準
- **SHA-3**（2015年）：最新の国際標準

---

## 8.4 インターネット時代の暗号応用

### SSL/TLSプロトコル

1990年代、インターネットの商用利用が始まると、Web通信の安全性が緊急課題となった。この問題を解決したのが、SSL（Secure Sockets Layer）プロトコルだった。

**SSL/TLS の発展**：
- **SSL 1.0**（1994年）：Netscape社が開発、実装されず
- **SSL 2.0**（1995年）：最初の実装版、重大な脆弱性あり
- **SSL 3.0**（1996年）：大幅改良版、広く普及
- **TLS 1.0**（1999年）：SSL 3.0を標準化、現在はTLSが正式名称
- **TLS 1.3**（2018年）：最新版、大幅な性能・安全性向上

**SSL/TLS の仕組み**：
```
1. クライアントがサーバーに接続要求
2. サーバーが証明書（公開鍵含む）を送信
3. クライアントが証明書を検証
4. Diffie-Hellman鍵交換で共通鍵を生成
5. 共通鍵による暗号化通信開始
```

SSL/TLS により、Webブラウザとサーバー間の通信が安全に行えるようになった。これにより、電子商取引、オンラインバンキング、Webメールなどが実用化された。

### PGP（Pretty Good Privacy）

1991年、フィル・ジマーマン（Phil Zimmermann）は「PGP（Pretty Good Privacy）」を開発・公開した。これは、一般ユーザーが使える実用的な暗号ソフトウェアだった。

**PGP の特徴**：
- **ハイブリッド暗号**：公開鍵暗号と共通鍵暗号の組み合わせ
- **デジタル署名**：メッセージの真正性保証
- **圧縮機能**：暗号化前のデータ圧縮
- **無料配布**：インターネットで自由にダウンロード可能

**PGP の社会的影響**：
- **暗号の民主化**：一般ユーザーでも軍事級の暗号を使用可能
- **政府との対立**：暗号輸出規制との衝突
- **プライバシー運動**：個人プライバシー保護の象徴
- **オープンソース暗号**：GNU Privacy Guard（GPG）への発展

### 電子商取引の安全性

1990年代後半、インターネット上での商取引が本格化すると、決済情報の保護が重要課題となった。

**電子商取引での暗号利用**：
- **SSL/TLS**：Webブラウザとサーバー間の通信保護
- **デジタル証明書**：サーバーの身元確認
- **暗号化決済**：クレジットカード情報の保護
- **電子署名**：取引の真正性保証

**主要な決済セキュリティ標準**：
- **SET（Secure Electronic Transaction）**：Visa・MasterCardが推進
- **3D Secure**：オンライン決済の本人認証
- **PCI DSS**：クレジットカード情報保護基準
- **EMV**：ICカードの国際標準

### Wi-Fi暗号化

無線LAN（Wi-Fi）の普及により、無線通信の暗号化も重要となった。

**Wi-Fi暗号化の発展**：
- **WEP（1997年）**：初期の暗号化、深刻な脆弱性
- **WPA（2003年）**：WEPの緊急改良版
- **WPA2（2004年）**：AES暗号化、長期間の標準
- **WPA3（2018年）**：最新の暗号化、より強固な安全性

**WPA2/WPA3 の暗号技術**：
- **AES暗号**：共通鍵暗号の最新標準
- **CCMP/GCMP**：認証付き暗号化モード
- **PSK/Enterprise**：個人用・企業用の認証方式
- **Perfect Forward Secrecy**：セッション鍵の前方秘匿性

---

## 8.5 現代暗号学の課題と未来

### 量子コンピュータの脅威

21世紀に入り、量子コンピュータの実用化が現実味を帯びてきた。量子コンピュータは、現在の公開鍵暗号の安全性を根本から脅かす可能性がある。

**量子コンピュータの暗号への影響**：
- **Shorのアルゴリズム**：素因数分解と離散対数を効率的に解く
- **RSA・DH・楕円曲線暗号**：量子コンピュータにより破られる可能性
- **AES等の共通鍵暗号**：鍵長を倍にすれば安全性維持可能
- **ハッシュ関数**：出力長を倍にすれば安全性維持可能

**量子コンピュータ脅威のタイムライン**：
- **現在**：小規模な量子コンピュータの実現
- **2030年代**：実用的な量子コンピュータの登場予測
- **影響範囲**：インターネット全体のセキュリティ
- **対策期間**：10-20年での完全移行が必要

### 耐量子暗号（Post-Quantum Cryptography）

量子コンピュータの脅威に対応するため、「耐量子暗号」の研究が活発化している。

**耐量子暗号の候補**：

**格子暗号**：
- **数学的基盤**：格子問題の困難性
- **特徴**：効率的、署名・暗号化両対応
- **代表例**：CRYSTALS-Kyber、CRYSTALS-Dilithium

**符号暗号**：
- **数学的基盤**：誤り訂正符号の困難性
- **特徴**：長い歴史、大きな鍵サイズ
- **代表例**：Classic McEliece

**多変数暗号**：
- **数学的基盤**：多変数多項式の求解困難性
- **特徴**：高速署名、大きな鍵サイズ
- **代表例**：Rainbow（破られたため非推奨）

**同種暗号**：
- **数学的基盤**：楕円曲線の同種写像
- **特徴**：小さな鍵サイズ、新しい分野
- **代表例**：SIKE（破られたため非推奨）

### NIST標準化プロセス

2016年、アメリカ国立標準技術研究所（NIST）は、耐量子暗号の標準化プロセスを開始した。

**標準化プロセス**：
- **第1ラウンド**（2017-2019）：69候補から26候補を選出
- **第2ラウンド**（2019-2020）：26候補から15候補を選出
- **第3ラウンド**（2020-2022）：7候補を最終審査
- **標準化完了**（2022年）：4つのアルゴリズムを標準化

**標準化されたアルゴリズム**：
1. **CRYSTALS-Kyber**：公開鍵暗号化
2. **CRYSTALS-Dilithium**：デジタル署名
3. **FALCON**：デジタル署名（コンパクト）
4. **SPHINCS+**：ハッシュベース署名

### 同形暗号（Homomorphic Encryption）

近年注目されている暗号技術の一つが「同形暗号」である。これは、暗号化されたデータのまま計算できる革新的な技術だ。

**同形暗号の特徴**：
```
従来の暗号：
暗号化 → 復号化 → 計算 → 暗号化

同形暗号：
暗号化 → 暗号文のまま計算 → 復号化
```

**同形暗号の応用**：
- **クラウドコンピューティング**：データを秘匿したままクラウドで計算
- **プライバシー保護データ分析**：個人情報を保護したまま統計処理
- **医療データ解析**：患者のプライバシーを守りながら医学研究
- **金融データ処理**：機密情報を保護したまま金融計算

**技術的課題**：
- **計算効率**：従来の計算より数千倍から数万倍遅い
- **実装複雑性**：高度な数学的知識が必要
- **適用範囲**：まだ限定的な計算しか実用化されていない

### プライバシー強化技術

現代社会では、データのプライバシー保護がますます重要になっている。暗号学はプライバシー保護の中核技術として発展している。

**主要な プライバシー保護技術**：

**ゼロ知識証明**：
- **概念**：秘密を明かすことなく、その秘密を知っていることを証明
- **応用**：本人認証、ブロックチェーン、プライバシー保護認証
- **例**：パスワードを送信せずにパスワードを知っていることを証明

**差分プライバシー**：
- **概念**：統計的な情報を提供しつつ個人情報を保護
- **応用**：国勢調査、Web解析、機械学習
- **仕組み**：データに適切なノイズを加えて個人を特定不可能にする

**安全な多者間計算（MPC）**：
- **概念**：複数の参加者が秘密を共有せずに共同計算
- **応用**：秘密投票、プライベートオークション、共同データ分析
- **例**：各自の年収を明かすことなく平均年収を計算

### 暗号学の社会的責任

現代の暗号学者は、技術的課題だけでなく、社会的責任も負っている。

**主要な社会的課題**：

**プライバシー vs 安全保障**：
- 個人のプライバシー保護の権利
- 犯罪防止・テロ対策の必要性
- 法執行機関のアクセス要求
- 技術的「バックドア」の是非

**デジタルデバイド**：
- 暗号技術へのアクセス格差
- 発展途上国での暗号技術普及
- 教育・リテラシーの重要性
- オープンソース暗号の意義

**技術の軍事利用**：
- 暗号技術の軍事転用可能性
- 輸出規制との関係
- 研究の自由と安全保障のバランス
- 国際協力の必要性

**規制とイノベーション**：
- 過度な規制によるイノベーション阻害
- 適切な規制による安全性確保
- 国際的な標準化の重要性
- 産学官連携の促進

ディフィーとヘルマンが1976年に始めた「暗号学の民主化」は、50年を経て新たな段階を迎えている。量子コンピュータ、AI、IoT等の新技術への対応、プライバシー保護の強化、社会的責任の履行—これらすべてが現代暗号学者の課題となっている。

二人が開いた「暗号の扉」は、デジタル社会の安全性の基盤となり、今後も人類のプライバシーと安全を守り続けるだろう。

---

## この章のポイント

### キーワード
- **公開鍵暗号**：暗号化鍵と復号化鍵が異なる革命的な暗号方式
- **デジタル署名**：電子文書の真正性と完全性を保証する技術
- **鍵配布問題**：事前の秘密共有なしに安全通信を実現する課題

### 現代への影響
- **インターネットセキュリティ**：SSL/TLS、デジタル証明書の基盤技術
- **電子商取引**：オンライン決済、デジタル契約の安全性保証
- **プライバシー保護**：個人データの暗号化、匿名通信技術

### ビジネスへの示唆
1. **不可能への挑戦**：常識を疑い、根本的な解決策を追求する姿勢
2. **学際的協力**：異なる専門分野の知識を組み合わせるイノベーション
3. **オープンな研究文化**：知識共有による技術発展の加速
4. **社会的責任**：技術の影響を考慮した倫理的な開発・普及

ホイットフィールド・ディフィーとマーティン・ヘルマンの物語は、数学的な美しさと実用的な価値が結びついた時の革新力を示している。彼らが解決した「鍵配布問題」は、現代デジタル社会の信頼性の基盤となっており、インターネット時代の安全性を支え続けている。